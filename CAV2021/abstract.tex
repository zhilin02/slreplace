\begin{abstract}
%% some background on regular expressions
Regular expressions (RE) are a classical concept in formal language theory.
%, which are expressions built from characters by the operators of concatenation, union, and Kleene star. 
Real-world regular expressions (RWRE) in programming languages differ from REs 
in the non-standard semantics of operators (e.g. non-commutative union and 
greedy/lazy Kleene star), as well as  the additional features like capturing
groups and backreferences. 
%% symbolic execution requires faithful encoding of regex semantics
%String constraint solvers are one of the cornerstones of the analysis and verification of string manipulating programs. Faithful encoding of the semantics of real-world regular expressions in string constraint solvers facilitates more precise program analysis and verification.
%% state of the art string constraint solvers
%The semantics of real-word regular expressions are tricky and vary in different programming languages. It is challenging for string constraint solvers to support real-world regular expressions.
While REs are supported by every state-of-the-art string constraint solver, 
RWREs are thus far unsupported. Recent works have suggested that the mismatch 
between REs %in string constraint 
%solvers and RWREs in programming languages 
%hinders the precision and efficiency 
makes it difficult for a symbolic execution engine to deal with RWREs,
which are hitherto approximated by a CEGAR-based approach, which performs
many satisfiability checks of string constraints with only REs.
%; hitherto,
%RWREs are either approximated away
%
%by resorting to approximate 
%encoding of RWREs and counter-example guided abstraction refinements (CEGAR).
%
%The semantics of real-world regular expressions are better to be encoded as faithfully as possible. For instance, in dynamic symbolic execution of string manipulating programs, in order to generate the inputs for execution paths and improve coverage,  the semantics of real-world regular expressions are better to be encoded as faithfully as possible in string constraint solvers. 
%% contribution
In this paper we propose an approach of natively supporting RWREs in string
constraint solving. 
The key of our approach is to introduce a new automata model called prioritized streaming string transducers (PSST), 
which combines priorities in prioritized finite transducers and string variables in streaming string transducers, to model the string functions involving RWREs.
%non-standard semantics of regular expression operators can be modeled by priorities and new features of capturing groups and back references can be modeled by string variables. 
%the non-standard semantics of regular expression operators can be modeled by priorities and new features of capturing groups and back references can be modeled by string variables. 
Based on PSSTs, we design a decision procedure for string constraints with 
RWREs and provide its implementation.
%% implementation and experiments
%We implement the decision procedure 
%and do extensive experiments to evaluate its performance. 
We evaluate its performance on on over 160,000 string constraints generated 
from RWREs in open-source programs.
Our approach dramatically improves the CEGAR-based approach for RWREs in both 
precision and efficiency. 
%To the best of our knowledge, this work represents the first string constraint solver supporting RWREs.
\end{abstract}
